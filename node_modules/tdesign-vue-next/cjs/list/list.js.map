{"version":3,"file":"list.js","sources":["../../src/list/list.tsx"],"sourcesContent":["import { defineComponent, VNodeChild, computed } from 'vue';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TdListProps } from './type';\nimport { LOAD_MORE, LOADING } from './const';\nimport { useConfig, usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport isString from 'lodash/isString';\n\nexport default defineComponent({\n  name: 'TList',\n  props: {\n    ...props,\n  },\n  setup(props: TdListProps) {\n    const { globalConfig } = useConfig('list');\n    const COMPONENT_NAME = usePrefixClass('list');\n    const { SIZE } = useCommonClassName();\n    const renderTNodeJSX = useTNodeJSX();\n\n    /** 列表基础逻辑 start */\n    const listClass = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}`,\n        SIZE.value[props.size],\n        {\n          [`${COMPONENT_NAME.value}--split`]: props.split,\n          [`${COMPONENT_NAME.value}--stripe`]: props.stripe,\n          [`${COMPONENT_NAME.value}--vertical-action`]: props.layout === 'vertical',\n        },\n      ];\n    });\n    const renderContent = (): VNodeChild => {\n      const propsHeaderContent = renderTNodeJSX('header');\n      const propsFooterContent = renderTNodeJSX('footer');\n      return [\n        propsHeaderContent && <div class={`${COMPONENT_NAME.value}__header`}>{propsHeaderContent}</div>,\n        <ul class={`${COMPONENT_NAME.value}__inner`}>{renderTNodeJSX('default')}</ul>,\n        propsFooterContent && <div class={`${COMPONENT_NAME.value}__footer`}>{propsFooterContent}</div>,\n      ];\n    };\n    /** 列表基础逻辑 end */\n\n    /** 滚动相关逻辑 start */\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const listElement = e.target as HTMLElement;\n      const { scrollTop, scrollHeight, clientHeight } = listElement;\n      props.onScroll?.({\n        e,\n        scrollTop,\n        scrollBottom: scrollHeight - clientHeight - scrollTop,\n      });\n    };\n    /** 滚动相关逻辑 end */\n\n    /** loading加载相关逻辑 start */\n    const loadingClass = computed(() => {\n      return isString(props.asyncLoading) && ['loading', 'load-more'].includes(props.asyncLoading)\n        ? `${COMPONENT_NAME.value}__load ${COMPONENT_NAME.value}__load--${props.asyncLoading}`\n        : `${COMPONENT_NAME.value}__load`;\n    });\n\n    const renderLoading = () => {\n      if (props.asyncLoading && isString(props.asyncLoading)) {\n        if (props.asyncLoading === LOADING) {\n          return (\n            <div>\n              <TLoading />\n              <span>{globalConfig.value.loadingText}</span>\n            </div>\n          );\n        }\n        if (props.asyncLoading === LOAD_MORE) {\n          return <span>{globalConfig.value.loadingMoreText}</span>;\n        }\n      }\n      return renderTNodeJSX('asyncLoading');\n    };\n\n    const handleLoadMore = (e: MouseEvent) => {\n      if (isString(props.asyncLoading) && props.asyncLoading !== LOAD_MORE) return;\n      props.onLoadMore?.({ e });\n    };\n    /** loading加载相关逻辑 end */\n    return {\n      COMPONENT_NAME,\n      listClass,\n      loadingClass,\n      renderLoading,\n      renderContent,\n      handleScroll,\n      handleLoadMore,\n    };\n  },\n\n  render() {\n    let listContent = this.renderContent();\n    listContent = [\n      listContent,\n      <div class={this.loadingClass} onClick={this.handleLoadMore}>\n        {this.renderLoading()}\n      </div>,\n    ];\n    return (\n      <div class={this.listClass} onScroll={this.handleScroll}>\n        {listContent}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","setup","_useConfig","useConfig","globalConfig","COMPONENT_NAME","usePrefixClass","_useCommonClassName","useCommonClassName","SIZE","renderTNodeJSX","useTNodeJSX","listClass","computed","_ref","concat","value","size","_defineProperty","split","stripe","layout","renderContent","propsHeaderContent","propsFooterContent","_createVNode","handleScroll","e","_props2$onScroll","listElement","target","scrollTop","scrollHeight","clientHeight","onScroll","scrollBottom","loadingClass","isString","asyncLoading","includes","renderLoading","LOADING","TLoading","loadingText","LOAD_MORE","loadingMoreText","handleLoadMore","_props2$onLoadMore","onLoadMore","render","listContent"],"mappings":"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"}