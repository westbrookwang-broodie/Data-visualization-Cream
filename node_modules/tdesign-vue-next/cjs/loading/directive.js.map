{"version":3,"file":"directive.js","sources":["../../src/loading/directive.ts"],"sourcesContent":["import type { Directive, DirectiveBinding } from 'vue';\nimport { TdLoadingProps } from './type';\nimport produceLoading from './plugin';\n\nconst INSTANCE_KEY = Symbol('TdLoading');\n\nconst createInstance = (el: HTMLElement, binding: DirectiveBinding) => {\n  const { fullscreen, inheritColor } = binding.modifiers;\n  const options: TdLoadingProps = {\n    attach: () => el,\n    fullscreen: fullscreen ?? false,\n    inheritColor: inheritColor ?? false,\n    loading: binding.value,\n  };\n\n  el[INSTANCE_KEY] = {\n    options,\n    instance: produceLoading(options),\n  };\n};\n\nexport const vLoading: Directive = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding);\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY];\n    const { value, oldValue } = binding;\n    if (!!oldValue !== !!value) {\n      if (value) {\n        createInstance(el, binding);\n      } else {\n        instance?.instance.hide();\n      }\n    }\n  },\n  unmounted(el) {\n    el[INSTANCE_KEY]?.instance.hide();\n  },\n};\n"],"names":["INSTANCE_KEY","Symbol","createInstance","el","binding","_binding$modifiers","modifiers","fullscreen","inheritColor","options","attach","loading","value","instance","produceLoading","vLoading","mounted","updated","oldValue","hide","unmounted","_el$INSTANCE_KEY"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,YAAA,GAAeC,OAAO,WAAW,CAAA,CAAA;AAEvC,IAAMC,cAAA,GAAiB,SAAjBA,cAAAA,CAAkBC,EAAA,EAAiBC,OAA8B,EAAA;AACrE,EAAA,IAAAC,kBAAA,GAAqCD,OAAQ,CAAAE,SAAA;IAArCC,UAAA,GAAAF,kBAAA,CAAAE,UAAA;IAAYC,YAAa,GAAAH,kBAAA,CAAbG,YAAa,CAAA;AACjC,EAAA,IAAMC,OAA0B,GAAA;IAC9BC,QAAQ,SAAAA,MAAA,GAAA;AAAA,MAAA,OAAMP,EAAA,CAAA;AAAA,KAAA;AACdI,IAAAA,YAAYA,UAAc,KAAA,IAAA,IAAdA,UAAc,KAAdA,KAAAA,CAAAA,GAAAA,UAAc,GAAA,KAAA;AAC1BC,IAAAA,cAAcA,YAAgB,KAAA,IAAA,IAAhBA,YAAgB,KAAhBA,KAAAA,CAAAA,GAAAA,YAAgB,GAAA,KAAA;IAC9BG,SAASP,OAAQ,CAAAQ,KAAAA;GACnB,CAAA;EAEAT,EAAA,CAAGH,YAAgB,CAAA,GAAA;AACjBS,IAAAA,OAAA,EAAAA,OAAA;IACAI,QAAA,EAAUC,0BAAeL,OAAO,CAAA;GAClC,CAAA;AACF,CAAA,CAAA;AAEO,IAAMM,QAAsB,GAAA;AACjCC,EAAAA,OAAA,EAAAA,SAAAA,OAAAA,CAAQb,IAAIC,OAAS,EAAA;IACnB,IAAIA,QAAQQ,KAAO,EAAA;AACjBV,MAAAA,cAAA,CAAeC,IAAIC,OAAO,CAAA,CAAA;AAC5B,KAAA;GACF;AACAa,EAAAA,OAAA,EAAAA,SAAAA,OAAAA,CAAQd,IAAIC,OAAS,EAAA;AACnB,IAAA,IAAMS,WAAWV,EAAG,CAAAH,YAAA,CAAA,CAAA;AACd,IAAA,IAAEY,KAAO,GAAaR,OAAA,CAApBQ,KAAO;MAAAM,QAAA,GAAad,OAAA,CAAbc,QAAA,CAAA;AACf,IAAA,IAAI,CAAC,CAACA,QAAa,KAAA,CAAC,CAACN,KAAO,EAAA;AAC1B,MAAA,IAAIA,KAAO,EAAA;AACTV,QAAAA,cAAA,CAAeC,IAAIC,OAAO,CAAA,CAAA;AAC5B,OAAO,MAAA;QACLS,QAAA,KAAA,IAAA,IAAAA,QAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,QAAA,CAAUA,SAASM,IAAK,EAAA,CAAA;AAC1B,OAAA;AACF,KAAA;GACF;EACAC,6BAAUjB,CAAAA,EAAI,EAAA;AAAA,IAAA,IAAAkB,gBAAA,CAAA;AACT,IAAA,CAAAA,gBAAA,GAAAlB,EAAA,CAAAH,YAAA,CAAA,MAAA,IAAA,IAAAqB,gBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,gBAAA,CAAeR,SAASM,IAAK,EAAA,CAAA;AAClC,GAAA;AACF;;;;"}