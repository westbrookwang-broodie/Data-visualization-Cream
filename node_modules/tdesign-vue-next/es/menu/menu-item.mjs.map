{"version":3,"file":"menu-item.mjs","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import { defineComponent, computed, inject, onMounted, ref, toRefs } from 'vue';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\nimport useRipple from '../hooks/useRipple';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  props: { ...props },\n  emits: ['click'],\n  setup(props, ctx) {\n    const { href, target = '_self' } = toRefs(props);\n    const classPrefix = usePrefixClass();\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const itemRef = ref<HTMLElement>();\n    useRipple(itemRef);\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const classes = computed(() => [\n      `${classPrefix.value}-menu__item`,\n      {\n        [`${classPrefix.value}-is-active`]: active.value,\n        [`${classPrefix.value}-is-disabled`]: props.disabled,\n        [`${classPrefix.value}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${classPrefix.value}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({ value: props.value, parent: submenu?.value, vnode: ctx.slots.default });\n    });\n\n    return {\n      classPrefix,\n      menu,\n      active,\n      classes,\n      itemRef,\n      href,\n      target,\n    };\n  },\n  methods: {\n    handleClick(e: MouseEvent) {\n      e.stopPropagation();\n      if (this.disabled) return;\n      this.menu.select(this.value);\n      emitEvent(this, 'click');\n      if (this.to) {\n        const router = this.router || this.$router;\n        const methods: string = this.replace ? 'replace' : 'push';\n        router[methods](this.to).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated' &&\n            !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n    },\n  },\n  render() {\n    return (\n      <li ref=\"itemRef\" class={this.classes} onClick={this.handleClick}>\n        {renderTNodeJSX(this, 'icon')}\n        {this.href ? (\n          <a href={this.href} target={this.target} className={`${this.classPrefix}-menu__item-link`}>\n            <span className={`${this.classPrefix}-menu__content`}>{renderContent(this, 'default', 'content')}</span>\n          </a>\n        ) : (\n          <span class={[`${this.classPrefix}-menu__content`]}>{renderContent(this, 'default', 'content')}</span>\n        )}\n      </li>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","emits","setup","ctx","_toRefs","toRefs","href","_toRefs$target","target","classPrefix","usePrefixClass","menu","inject","itemRef","ref","useRipple","submenu","active","computed","activeValue","value","classes","_ref","concat","_defineProperty","disabled","slots","icon","isHead","onMounted","_menu$vMenu","vMenu","add","parent","vnode","methods","handleClick","e","stopPropagation","select","emitEvent","to","router","$router","replace","err","message","includes","render","_createVNode","renderTNodeJSX","renderContent"],"mappings":"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"}