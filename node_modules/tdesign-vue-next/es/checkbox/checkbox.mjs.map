{"version":3,"file":"checkbox.mjs","sources":["../../src/checkbox/checkbox.tsx"],"sourcesContent":["import { defineComponent, ref, toRefs, computed, inject } from 'vue';\nimport props from './props';\nimport useVModel from '../hooks/useVModel';\nimport { useFormDisabled } from '../form/hooks';\nimport useRipple from '../hooks/useRipple';\nimport { useContent } from '../hooks/tnode';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { CheckboxGroupInjectionKey } from './constants';\n\nexport default defineComponent({\n  name: 'TCheckbox',\n  props: {\n    ...props,\n    needRipple: Boolean,\n    stopLabelTrigger: Boolean,\n  },\n\n  setup(props) {\n    const labelRef = ref<HTMLElement>();\n    if (props.needRipple) {\n      useRipple(labelRef);\n    }\n\n    const { checked, modelValue } = toRefs(props);\n    const [innerChecked, setInnerChecked] = useVModel(\n      checked,\n      modelValue,\n      props.defaultChecked,\n      props.onChange,\n      'checked',\n    );\n\n    const checkboxGroup = inject(CheckboxGroupInjectionKey, undefined);\n    const GroupDisabled = computed(() => {\n      return props.disabled || !!checkboxGroup?.disabled;\n    });\n    const formDisabled = useFormDisabled(GroupDisabled);\n\n    const name = computed<string>(() => props.name || checkboxGroup?.name);\n\n    const selfChecked = computed<boolean>(() => {\n      if (props.checkAll) return checkboxGroup?.isCheckAll;\n      return checkboxGroup ? !!checkboxGroup.checkedMap[props.value] : innerChecked.value;\n    });\n\n    const disabled = computed<boolean>(() => {\n      if (formDisabled.value) return formDisabled.value;\n      if (!props.checkAll && !selfChecked.value && checkboxGroup?.maxExceeded) {\n        return true;\n      }\n      if (props.disabled !== undefined) return props.disabled;\n      return !!checkboxGroup?.disabled;\n    });\n\n    const selfIndeterminate = computed<boolean>(() => {\n      if (props.checkAll) return checkboxGroup?.indeterminate;\n      return props.indeterminate;\n    });\n\n    /** 样式计算相关逻辑 */\n    const classPrefix = usePrefixClass();\n    const COMPONENT_NAME = usePrefixClass('checkbox');\n    const labelClasses = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      {\n        [`${classPrefix.value}-is-checked`]: selfChecked.value,\n        [`${classPrefix.value}-is-disabled`]: disabled.value,\n        [`${classPrefix.value}-is-indeterminate`]: selfIndeterminate.value,\n      },\n    ]);\n\n    // methods\n    const handleChange = (e: Event) => {\n      if (props.readonly) return;\n      const checked = !selfChecked.value;\n      setInnerChecked(checked, { e });\n      if (checkboxGroup && checkboxGroup.handleCheckboxChange) {\n        checkboxGroup.onCheckedChange({ checked, checkAll: props.checkAll, e, option: props });\n      }\n    };\n\n    const renderContent = useContent();\n\n    const handleLabelClick = (e: MouseEvent) => {\n      // 在tree等组件中使用  阻止label触发checked 与expand冲突\n      if (props.stopLabelTrigger) e.preventDefault();\n    };\n\n    return () => (\n      <label class={labelClasses.value} ref=\"labelRef\">\n        <input\n          type=\"checkbox\"\n          class={`${COMPONENT_NAME.value}__former`}\n          disabled={disabled.value}\n          readonly={props.readonly}\n          indeterminate={props.indeterminate}\n          name={name.value}\n          value={props.value}\n          checked={selfChecked.value}\n          onChange={handleChange}\n        ></input>\n        <span class={`${COMPONENT_NAME.value}__input`}></span>\n        <span class={`${COMPONENT_NAME.value}__label`} onClick={handleLabelClick}>\n          {renderContent('default', 'label')}\n        </span>\n      </label>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","needRipple","Boolean","stopLabelTrigger","setup","labelRef","ref","useRipple","_toRefs","toRefs","checked","modelValue","_useVModel","useVModel","defaultChecked","onChange","_useVModel2","_slicedToArray","innerChecked","setInnerChecked","checkboxGroup","inject","CheckboxGroupInjectionKey","GroupDisabled","computed","disabled","formDisabled","useFormDisabled","selfChecked","checkAll","isCheckAll","checkedMap","value","maxExceeded","selfIndeterminate","indeterminate","classPrefix","usePrefixClass","COMPONENT_NAME","labelClasses","_ref","concat","_defineProperty","handleChange","e","readonly","handleCheckboxChange","onCheckedChange","option","renderContent","useContent","handleLabelClick","preventDefault","_createVNode"],"mappings":"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"}