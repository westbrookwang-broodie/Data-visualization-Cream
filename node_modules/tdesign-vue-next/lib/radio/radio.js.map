{"version":3,"file":"radio.js","sources":["../../src/radio/radio.tsx"],"sourcesContent":["import { defineComponent, inject, toRefs, computed, ref } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport { omit } from '../utils/helper';\nimport props from './props';\nimport { RadioGroupInjectionKey, RadioButtonInjectionKey } from './constants';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\nimport { useContent } from '../hooks/tnode';\nimport isUndefined from 'lodash/isUndefined';\nimport isString from 'lodash/isString';\n\nfunction getValidAttrs(obj: Record<string, any>): Record<string, any> {\n  const newObj = {};\n  Object.keys(obj).forEach((key) => {\n    if (!isUndefined(obj[key])) {\n      newObj[key] = obj[key];\n    }\n  });\n  return newObj;\n}\n\nexport default defineComponent({\n  name: 'TRadio',\n  inheritAttrs: false,\n  props: { ...props },\n\n  setup(props, { attrs }) {\n    const inputRef = ref();\n    const { checked, modelValue } = toRefs(props);\n    const [innerChecked, setInnerChecked] = useVModel(\n      checked,\n      modelValue,\n      props.defaultChecked,\n      props.onChange,\n      'checked',\n    );\n\n    const radioChecked = computed(() => (radioGroup ? props.value === radioGroup.value : innerChecked.value));\n\n    const radioGroup = inject(RadioGroupInjectionKey, undefined);\n\n    const allowUncheck = computed(() => Boolean(props.allowUncheck || radioGroup?.allowUncheck));\n\n    const handleClick = (e: MouseEvent) => {\n      e.stopPropagation();\n    };\n\n    const onLabelClick = (e: MouseEvent) => {\n      if (disabled.value) return;\n      props.onClick?.({ e });\n      if (radioGroup) {\n        const value = radioChecked.value && allowUncheck.value ? undefined : props.value;\n        radioGroup.setValue(value, { e });\n      } else {\n        const value = allowUncheck.value ? !radioChecked.value : true;\n        setInnerChecked(value, { e });\n      }\n    };\n\n    const inputEvents = computed(() =>\n      getValidAttrs({\n        focus: attrs.onFocus,\n        blur: attrs.onBlur,\n        keydown: attrs.onKeydown,\n        keyup: attrs.onKeyup,\n        keypresss: attrs.onKeypresss,\n      }),\n    );\n    const wrapperAttrs = computed(() => {\n      const events = [...Object.keys(inputEvents.value), 'input', 'change'].map(\n        (str) => `on${str[0].toUpperCase()}${str.slice(1)}`,\n      );\n      return omit(attrs, events);\n    });\n    /** Event END */\n\n    // extend radioGroup disabled props\n    const groupDisabled = computed(() => radioGroup?.disabled);\n    const disabled = useFormDisabled(groupDisabled);\n\n    // attribute\n    const inputProps = computed(() => ({\n      name: radioGroup ? radioGroup.name : props.name,\n      checked: radioChecked.value,\n      disabled: disabled.value,\n      value: props.value,\n    }));\n\n    /** Style */\n    const { STATUS } = useCommonClassName();\n    const radioButton = inject(RadioButtonInjectionKey, undefined);\n    const radioBtnName = usePrefixClass('radio-button');\n    const COMPONENT_NAME = usePrefixClass('radio');\n    const prefixCls = computed(() => (radioButton ? radioBtnName.value : COMPONENT_NAME.value));\n    const inputClass = computed(() => [\n      `${prefixCls.value}`,\n      {\n        [STATUS.value.checked]: inputProps.value.checked,\n        [STATUS.value.disabled]: inputProps.value.disabled,\n      },\n    ]);\n    /** Style END */\n\n    const renderContent = useContent();\n\n    return () => (\n      <label\n        ref={inputRef}\n        class={inputClass.value}\n        {...wrapperAttrs.value}\n        tabindex={disabled.value ? undefined : '0'}\n        onClick={onLabelClick}\n      >\n        <input\n          type=\"radio\"\n          class={`${prefixCls.value}__former`}\n          {...inputEvents.value}\n          {...inputProps.value}\n          onClick={handleClick}\n          tabindex=\"-1\"\n          data-value={isString(props.value) ? `'${props.value}'` : props.value}\n          data-allow-uncheck={allowUncheck.value || undefined}\n        />\n        <span class={`${prefixCls.value}__input`}></span>\n        <span class={`${prefixCls.value}__label`}>{renderContent('default', 'label')}</span>\n      </label>\n    );\n  },\n});\n"],"names":["getValidAttrs","obj","newObj","Object","keys","forEach","key","isUndefined","defineComponent","name","inheritAttrs","props","_objectSpread","setup","attrs","_ref","inputRef","ref","_toRefs","toRefs","checked","modelValue","_useVModel","useVModel","defaultChecked","onChange","_useVModel2","_slicedToArray","innerChecked","setInnerChecked","radioChecked","computed","radioGroup","value","inject","RadioGroupInjectionKey","allowUncheck","Boolean","handleClick","e","stopPropagation","onLabelClick","_props2$onClick","disabled","onClick","setValue","inputEvents","focus","onFocus","blur","onBlur","keydown","onKeydown","keyup","onKeyup","keypresss","onKeypresss","wrapperAttrs","events","concat","_toConsumableArray","map","str","toUpperCase","slice","omit","groupDisabled","useFormDisabled","inputProps","_useCommonClassName","useCommonClassName","STATUS","radioButton","RadioButtonInjectionKey","radioBtnName","usePrefixClass","COMPONENT_NAME","prefixCls","inputClass","_ref2","_defineProperty","renderContent","useContent","_createVNode","_mergeProps","isString"],"mappings":"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"}