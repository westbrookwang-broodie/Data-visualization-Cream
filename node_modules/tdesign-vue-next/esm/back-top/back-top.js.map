{"version":3,"file":"back-top.js","sources":["../../src/back-top/back-top.tsx"],"sourcesContent":["import { computed, defineComponent, onMounted, ref } from 'vue';\nimport { BacktopIcon as TdBackTopIcon } from 'tdesign-icons-vue-next';\n\nimport { scrollTo } from '../utils/dom';\nimport { useChildSlots, usePrefixClass, useContent, useConfig } from '../hooks';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport props from './props';\n\nimport type { TdBackTopProps } from './type';\n\nexport default defineComponent({\n  name: 'TBackTop',\n  props,\n  setup(props: TdBackTopProps) {\n    const visible = ref(false);\n    const containerRef = ref(null);\n    const componentName = usePrefixClass('back-top');\n    const { classPrefix } = useConfig('alert');\n\n    const { BacktopIcon } = useGlobalIcon({\n      BacktopIcon: TdBackTopIcon,\n    });\n    const renderContent = useContent();\n    const getContainer = (container: TdBackTopProps['container']) => {\n      if (typeof container === 'string' && typeof document !== undefined) {\n        if (container === 'body') {\n          return document;\n        }\n        return document.querySelector(container);\n      }\n      if (typeof container === 'function') {\n        return container();\n      }\n      return null;\n    };\n    onMounted(() => {\n      containerRef.value = getContainer(props.container) as HTMLElement;\n      let visibleHeight: number;\n      if (typeof props.visibleHeight === 'string') {\n        visibleHeight = Number(props.visibleHeight.replace('px', ''));\n      } else {\n        visibleHeight = props.visibleHeight;\n      }\n      if (visibleHeight === 0) {\n        visible.value = true;\n        return;\n      }\n      let scrollDOM: HTMLElement;\n      if (containerRef.value.scrollTop === undefined) {\n        scrollDOM = document.documentElement;\n      } else {\n        scrollDOM = containerRef.value;\n      }\n      containerRef.value.onscroll = () => {\n        const scrollTop = scrollDOM.scrollTop;\n        if (scrollTop >= visibleHeight) {\n          visible.value = true;\n          containerRef.value.onscroll = null;\n        }\n      };\n    });\n    return () => {\n      const { theme, shape, size, target, duration, offset, container } = props;\n      const getChild = useChildSlots();\n      let children = getChild();\n      if (children.length < 1) children = null;\n      const cls = computed(() => {\n        return {\n          [componentName.value]: true,\n          [`${componentName.value}--theme-${theme}`]: true,\n          [`${componentName.value}--${shape}`]: true,\n          [`${componentName.value}--show`]: visible.value,\n          [`${classPrefix.value}-size-s`]: size === 'small',\n          [`${classPrefix.value}-size-m`]: size === 'medium',\n        };\n      });\n      const defaultContent = (\n        <>\n          <BacktopIcon class={`${componentName.value}__icon`} size={'24'} />\n          <span class={`${componentName.value}__text`}>TOP</span>\n        </>\n      );\n      const getBackTo = () => {\n        if (target === container) return 0;\n        if (target === 'body') return 0;\n        if (!target) return 0;\n        const targetNode = getContainer(target);\n        if (!targetNode) return 0;\n        const y = (targetNode as HTMLElement).getBoundingClientRect().y;\n        return y;\n      };\n      const handleClick = (e: MouseEvent) => {\n        const y = getBackTo();\n        scrollTo(y, { container: containerRef.value, duration });\n        props.onClick?.({ e });\n      };\n      const positionStyle = computed(() => {\n        return {\n          insetInlineEnd: offset[0],\n          insetBlockEnd: offset[1],\n        };\n      });\n      return (\n        <button type=\"button\" class={cls.value} style={positionStyle.value} onClick={handleClick}>\n          {renderContent('content', 'default', defaultContent)}\n        </button>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","visible","ref","containerRef","componentName","usePrefixClass","_useConfig","useConfig","classPrefix","_useGlobalIcon","useGlobalIcon","BacktopIcon","TdBackTopIcon","renderContent","useContent","getContainer","container","document","querySelector","onMounted","value","visibleHeight","Number","replace","scrollDOM","scrollTop","documentElement","onscroll","theme","shape","size","target","duration","offset","getChild","useChildSlots","children","length","cls","computed","_ref","_defineProperty","concat","defaultContent","_createVNode","_Fragment","_createTextVNode","getBackTo","targetNode","y","getBoundingClientRect","handleClick","e","_props2$onClick","scrollTo","onClick","positionStyle","insetInlineEnd","insetBlockEnd"],"mappings":"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"}