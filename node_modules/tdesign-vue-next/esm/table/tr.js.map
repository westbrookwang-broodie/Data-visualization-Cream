{"version":3,"file":"tr.js","sources":["../../src/table/tr.tsx"],"sourcesContent":["import { defineComponent, PropType, SetupContext, h, computed, ref, reactive, toRefs, watch } from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport upperFirst from 'lodash/upperFirst';\nimport isString from 'lodash/isString';\nimport pick from 'lodash/pick';\nimport get from 'lodash/get';\nimport { formatClassNames, formatRowAttributes, formatRowClassNames } from './utils';\nimport { getRowFixedStyles, getColumnFixedStyles } from './hooks/useFixed';\nimport useClassName from './hooks/useClassName';\nimport TEllipsis from './ellipsis';\nimport { BaseTableCellParams, TableRowData, RowspanColspan, TdPrimaryTableProps, TdBaseTableProps } from './type';\nimport baseTableProps from './base-table-props';\nimport useLazyLoad from './hooks/useLazyLoad';\nimport { RowAndColFixedPosition } from './interface';\nimport { getCellKey, SkipSpansValue } from './hooks/useRowspanAndColspan';\nimport { TooltipProps } from '../tooltip';\nimport { PaginationProps } from '..';\nimport { VirtualScrollConfig } from '../hooks/useVirtualScrollNew';\nimport { AttachNode } from '../common';\n\nexport interface RenderTdExtra {\n  rowAndColFixedPosition: RowAndColFixedPosition;\n  columnLength: number;\n  dataLength: number;\n  cellSpans: RowspanColspan;\n  cellEmptyContent: TdBaseTableProps['cellEmptyContent'];\n}\n\nexport interface RenderEllipsisCellParams {\n  cellNode: any;\n}\n\nexport type TrCommonProps = Pick<TdPrimaryTableProps, TrPropsKeys>;\n\nexport const TABLE_PROPS = [\n  'rowKey',\n  'rowClassName',\n  'columns',\n  'fixedRows',\n  'footData',\n  'rowAttributes',\n  'rowspanAndColspan',\n  'scroll',\n  'cellEmptyContent',\n  'pagination',\n  'attach',\n  'onCellClick',\n  'onRowClick',\n  'onRowDblclick',\n  'onRowMouseover',\n  'onRowMousedown',\n  'onRowMouseenter',\n  'onRowMouseleave',\n  'onRowMouseup',\n] as const;\n\nexport type TrPropsKeys = typeof TABLE_PROPS[number];\n\nexport interface TrProps extends TrCommonProps {\n  rowKey: string;\n  row: TableRowData;\n  rowIndex: number;\n  ellipsisOverlayClassName: string;\n  classPrefix: string;\n  dataLength: number;\n  rowAndColFixedPosition?: RowAndColFixedPosition;\n  skipSpansMap?: Map<string, SkipSpansValue>;\n  tableElm?: any;\n  // HTMLDivElement\n  tableContentElm?: any;\n  cellEmptyContent: TdBaseTableProps['cellEmptyContent'];\n  virtualConfig: VirtualScrollConfig;\n  attach?: AttachNode;\n}\n\nexport const ROW_LISTENERS = ['click', 'dblclick', 'mouseover', 'mousedown', 'mouseenter', 'mouseleave', 'mouseup'];\n\nexport function renderCell(\n  params: BaseTableCellParams<TableRowData>,\n  slots: SetupContext['slots'],\n  extra?: {\n    cellEmptyContent?: TdBaseTableProps['cellEmptyContent'];\n    pagination?: PaginationProps;\n  },\n) {\n  const { col, row, rowIndex } = params;\n  // support serial number column\n  if (col.colKey === 'serial-number') {\n    const { current, pageSize, defaultCurrent, defaultPageSize } = extra?.pagination || {};\n    const tCurrent = current || defaultCurrent;\n    const tPageSize = pageSize || defaultPageSize;\n    if (tPageSize && tCurrent) {\n      return tPageSize * (tCurrent - 1) + rowIndex + 1;\n    }\n    return rowIndex + 1;\n  }\n  if (isFunction(col.cell)) {\n    return col.cell(h, params);\n  }\n  if (slots[col.colKey]) {\n    return slots[col.colKey](params);\n  }\n  if (isString(col.cell) && slots[col.cell]) {\n    return slots[col.cell](params);\n  }\n  if (isFunction(col.render)) {\n    return col.render(h, { ...params, type: 'cell' });\n  }\n  const r = get(row, col.colKey);\n  // 0 和 false 属于正常可用之，不能使用兜底逻辑 cellEmptyContent\n  if (![undefined, '', null].includes(r)) return r;\n  // cellEmptyContent 作为空数据兜底显示，用户可自定义\n  if (extra?.cellEmptyContent) {\n    return isFunction(extra.cellEmptyContent) ? extra.cellEmptyContent(h, params) : extra.cellEmptyContent;\n  }\n  if (slots.cellEmptyContent) return slots.cellEmptyContent(params);\n  if (slots['cell-empty-content']) return slots['cell-empty-content'](params);\n  return r;\n}\n\n// 表格行组件\nexport default defineComponent({\n  name: 'TR',\n\n  props: {\n    row: Object as PropType<TableRowData>,\n    rowIndex: Number,\n    dataLength: Number,\n    ellipsisOverlayClassName: String,\n    classPrefix: String,\n    rowAndColFixedPosition: Map as PropType<RowAndColFixedPosition>,\n    // 合并单元格，是否跳过渲染\n    skipSpansMap: Map as PropType<TrProps['skipSpansMap']>,\n    virtualConfig: Object as PropType<TrProps['virtualConfig']>,\n    ...pick(baseTableProps, TABLE_PROPS),\n    // eslint-disable-next-line\n    tableElm: {},\n    // eslint-disable-next-line\n    tableContentElm: {},\n  },\n\n  emits: ['row-mounted'],\n\n  setup(props: TrProps, context: SetupContext) {\n    const { tableContentElm } = toRefs(props);\n    const trRef = ref(null);\n    const {\n      tdEllipsisClass,\n      tableBaseClass,\n      tableColFixedClasses,\n      tableRowFixedClasses,\n      tdAlignClasses,\n      tableDraggableClasses,\n    } = useClassName();\n    const trStyles = computed(() =>\n      getRowFixedStyles(\n        get(props.row, props.rowKey || 'id'),\n        props.rowIndex,\n        props.dataLength,\n        props.fixedRows,\n        props.rowAndColFixedPosition,\n        tableRowFixedClasses,\n      ),\n    );\n\n    const trAttributes = computed(\n      () => formatRowAttributes(props.rowAttributes, { row: props.row, rowIndex: props.rowIndex, type: 'body' }) || {},\n    );\n\n    const classes = computed(() => {\n      const customClasses = formatRowClassNames(\n        props.rowClassName,\n        { row: props.row, rowIndex: props.rowIndex, type: 'body' },\n        props.rowKey || 'id',\n      );\n      return [trStyles.value?.classes, customClasses].filter((v) => v);\n    });\n\n    const { hasLazyLoadHolder, tRowHeight } = useLazyLoad(\n      tableContentElm,\n      trRef,\n      reactive({ ...props.scroll, rowIndex: props.rowIndex }),\n    );\n\n    const getTrListeners = (row: TableRowData, rowIndex: number) => {\n      const trListeners: { [eventName: string]: (e: MouseEvent) => void } = {};\n      // add events to row\n      ROW_LISTENERS.forEach((eventName) => {\n        trListeners[`on${upperFirst(eventName)}`] = (e: MouseEvent) => {\n          const p = { e, row, index: rowIndex };\n          props[`onRow${upperFirst(eventName)}`]?.(p);\n        };\n      });\n      return trListeners;\n    };\n\n    watch([trRef], () => {\n      if (props.virtualConfig?.isVirtualScroll.value) {\n        context.emit('row-mounted', {\n          ref: trRef,\n          data: props.row,\n        });\n      }\n    });\n\n    function renderEllipsisCell(cellParams: BaseTableCellParams<TableRowData>, params: RenderEllipsisCellParams) {\n      const { cellNode } = params;\n      const { col, colIndex } = cellParams;\n      let content = isFunction(col.ellipsis) ? col.ellipsis(h, cellParams) : undefined;\n      if (typeof col.ellipsis === 'object' && isFunction(col.ellipsis.content)) {\n        content = col.ellipsis.content(h, cellParams);\n      }\n      let tooltipProps = {};\n      if (typeof col.ellipsis === 'object') {\n        tooltipProps = 'props' in col.ellipsis ? col.ellipsis.props : col.ellipsis || undefined;\n      }\n      const tableElement = props.tableElm as HTMLDivElement;\n      let placement: TooltipProps['placement'] = colIndex === 0 ? 'top-left' : 'top';\n      placement = colIndex === props.columns.length - 1 ? 'top-right' : placement;\n      return (\n        <TEllipsis\n          placement={placement}\n          attach={tableElement ? () => tableElement : undefined}\n          tooltipContent={content && (() => content)}\n          tooltipProps={tooltipProps}\n          overlayClassName={props.ellipsisOverlayClassName}\n          classPrefix={props.classPrefix}\n        >\n          {cellNode}\n        </TEllipsis>\n      );\n    }\n\n    function renderTd(params: BaseTableCellParams<TableRowData>, extra: RenderTdExtra) {\n      const { col, colIndex, rowIndex } = params;\n      const { cellSpans, dataLength, rowAndColFixedPosition } = extra;\n      const cellNode = renderCell(params, context.slots, {\n        cellEmptyContent: extra.cellEmptyContent,\n        pagination: props.pagination,\n      });\n      const tdStyles = getColumnFixedStyles(col, colIndex, rowAndColFixedPosition, tableColFixedClasses);\n      const customClasses = formatClassNames(col.className, { ...params, type: 'td' });\n      const classes = [\n        tdStyles.classes,\n        customClasses,\n        {\n          [tdEllipsisClass]: col.ellipsis,\n          [tableBaseClass.tdLastRow]: rowIndex + cellSpans.rowspan === dataLength,\n          [tableBaseClass.tdFirstCol]: colIndex === 0 && props.rowspanAndColspan,\n          [tdAlignClasses[col.align]]: col.align && col.align !== 'left',\n          // 标记可拖拽列\n          [tableDraggableClasses.handle]: col.colKey === 'drag',\n        },\n      ];\n      const onClick = (e: MouseEvent) => {\n        const p = { ...params, e };\n        if (col.stopPropagation) {\n          e.stopPropagation();\n        }\n        props.onCellClick?.(p);\n      };\n      const normalAttrs = isFunction(col.attrs) ? col.attrs({ ...params, type: 'td' }) : col.attrs;\n      const attrs = { ...normalAttrs, ...cellSpans };\n      return (\n        <td key={col.colKey || colIndex} class={classes} style={tdStyles.style} {...attrs} onClick={onClick}>\n          {col.ellipsis ? renderEllipsisCell(params, { cellNode }) : cellNode}\n        </td>\n      );\n    }\n\n    return () => {\n      const { columns, skipSpansMap, row, dataLength, rowAndColFixedPosition } = props;\n      const columVNodeList = columns?.map((col, colIndex) => {\n        const cellSpans: RowspanColspan = {};\n        const params = {\n          row,\n          col,\n          rowIndex: props.rowIndex,\n          colIndex,\n        };\n        let spanState = null;\n        if (props.skipSpansMap.size) {\n          const cellKey = getCellKey(row, props.rowKey, col.colKey, colIndex);\n          spanState = skipSpansMap.get(cellKey) || {};\n          spanState?.rowspan > 1 && (cellSpans.rowspan = spanState.rowspan);\n          spanState?.colspan > 1 && (cellSpans.colspan = spanState.colspan);\n          if (spanState.skipped) return null;\n        }\n        return renderTd(params, {\n          dataLength,\n          rowAndColFixedPosition,\n          columnLength: columns.length,\n          cellSpans,\n          cellEmptyContent: props.cellEmptyContent,\n        });\n      });\n      return (\n        <tr\n          ref={trRef}\n          {...trAttributes.value}\n          style={trStyles.value?.style}\n          class={classes.value}\n          {...getTrListeners(row, props.rowIndex)}\n        >\n          {hasLazyLoadHolder.value\n            ? [<td style={{ height: `${tRowHeight.value}px`, border: 'none' }} />]\n            : columVNodeList}\n        </tr>\n      );\n    };\n  },\n});\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","TABLE_PROPS","ROW_LISTENERS","renderCell","params","slots","extra","col","row","rowIndex","colKey","_ref","pagination","current","pageSize","defaultCurrent","defaultPageSize","tCurrent","tPageSize","isFunction","cell","h","isString","render","_objectSpread","type","r","get","includes","cellEmptyContent","defineComponent","name","props","Number","dataLength","ellipsisOverlayClassName","String","classPrefix","rowAndColFixedPosition","Map","skipSpansMap","virtualConfig","pick","baseTableProps","tableElm","tableContentElm","emits","setup","context","_toRefs","toRefs","trRef","ref","_useClassName","useClassName","tdEllipsisClass","tableBaseClass","tableColFixedClasses","tableRowFixedClasses","tdAlignClasses","tableDraggableClasses","trStyles","computed","getRowFixedStyles","rowKey","fixedRows","trAttributes","formatRowAttributes","rowAttributes","classes","_trStyles$value","customClasses","formatRowClassNames","rowClassName","value","filter","v","_useLazyLoad","useLazyLoad","reactive","scroll","hasLazyLoadHolder","tRowHeight","getTrListeners","trListeners","forEach","eventName","concat","upperFirst","e","_props","p","index","watch","_props$virtualConfig","isVirtualScroll","emit","data","renderEllipsisCell","cellParams","cellNode","colIndex","content","ellipsis","_typeof","tooltipProps","tableElement","placement","columns","length","_createVNode","TEllipsis","_default","renderTd","_ref2","cellSpans","tdStyles","getColumnFixedStyles","formatClassNames","className","_defineProperty","tdLastRow","rowspan","tdFirstCol","rowspanAndColspan","align","handle","onClick","_props$onCellClick","stopPropagation","onCellClick","normalAttrs","attrs","_mergeProps","style","_trStyles$value2","columVNodeList","map","spanState","size","_spanState","_spanState2","cellKey","getCellKey","colspan","skipped","columnLength","height","border"],"mappings":"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"}