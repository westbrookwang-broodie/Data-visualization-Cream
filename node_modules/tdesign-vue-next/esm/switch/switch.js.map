{"version":3,"file":"switch.js","sources":["../../src/switch/switch.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild, computed, watch, toRefs } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TNodeReturnValue } from '../common';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\nimport isFunction from 'lodash/isFunction';\nimport isString from 'lodash/isString';\nimport isArray from 'lodash/isArray';\n\nexport default defineComponent({\n  name: 'TSwitch',\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const disabled = useFormDisabled();\n    const COMPONENT_NAME = usePrefixClass('switch');\n    const { STATUS, SIZE } = useCommonClassName();\n    // values\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setSwitchVal] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    const activeValue = computed(() => {\n      if (props.customValue && props.customValue.length > 0) {\n        return props.customValue[0];\n      }\n      return true;\n    });\n    const inactiveValue = computed(() => {\n      if (props.customValue && props.customValue.length > 1) {\n        return props.customValue[1];\n      }\n      return false;\n    });\n\n    // methods\n    function handleToggle() {\n      const checked = innerValue.value === activeValue.value ? inactiveValue.value : activeValue.value;\n      // emits\n      setSwitchVal(checked);\n    }\n\n    function toggle() {\n      if (disabled.value || props.loading) {\n        return;\n      }\n      handleToggle();\n    }\n\n    // classes\n    const classes = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      SIZE.value[props.size],\n      {\n        [STATUS.value.disabled]: disabled.value,\n        [STATUS.value.loading]: props.loading,\n        [STATUS.value.checked]: innerValue.value === activeValue.value || props.modelValue === activeValue.value,\n      },\n    ]);\n    const nodeClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__handle`,\n        {\n          [STATUS.value.disabled]: disabled.value,\n          [STATUS.value.loading]: props.loading,\n        },\n      ];\n    });\n    const contentClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content`,\n        SIZE.value[props.size],\n        {\n          [STATUS.value.disabled]: disabled.value,\n        },\n      ];\n    });\n\n    watch(\n      innerValue,\n      (val) => {\n        if (props.customValue && props.customValue.length && !props.customValue.includes(val)) {\n          throw new Error(`value is not in ${JSON.stringify(props.customValue)}`);\n        }\n      },\n      {\n        immediate: true,\n      },\n    );\n\n    const content = computed<VNodeChild>(() => {\n      if (isFunction(props.label)) {\n        return props.label(h, { value: innerValue.value });\n      }\n      if (isString(props.label)) {\n        return props.label;\n      }\n      if (isArray(props.label) && props.label.length) {\n        const label = innerValue.value === activeValue.value ? props.label[0] : props.label[1];\n        if (!label) return;\n        if (isString(label)) {\n          return label;\n        }\n        if (isFunction(label)) {\n          return label(h);\n        }\n      }\n      if (slots.label) {\n        return slots.label({ value: innerValue.value });\n      }\n      return null;\n    });\n    return () => {\n      let switchContent: VNodeChild;\n      let loadingContent: TNodeReturnValue;\n      if (props.loading) {\n        loadingContent = <TLoading size=\"small\" />;\n      } else if (content.value) {\n        switchContent = content.value;\n      }\n\n      return (\n        <div class={classes.value} disabled={disabled.value} onClick={toggle}>\n          <span class={nodeClasses.value}>{loadingContent}</span>\n          <div class={contentClasses.value}>{switchContent}</div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","setup","slots","_ref","disabled","useFormDisabled","COMPONENT_NAME","usePrefixClass","_useCommonClassName","useCommonClassName","STATUS","SIZE","_toRefs","toRefs","value","modelValue","_useVModel","useVModel","defaultValue","onChange","_useVModel2","_slicedToArray","innerValue","setSwitchVal","activeValue","computed","customValue","length","inactiveValue","handleToggle","checked","toggle","loading","classes","_ref2","concat","size","_defineProperty","nodeClasses","_ref3","contentClasses","watch","val","includes","Error","JSON","stringify","immediate","content","isFunction","label","h","isString","isArray","switchContent","loadingContent","_createVNode","TLoading"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaA,cAAeA,eAAgB,CAAA;AAC7BC,EAAAA,IAAM,EAAA,SAAA;AACNC,EAAAA,KAAA,EAAAC,aAAA,CAAYD,EAAAA,EAAAA,KAAM,CAAA;AAElBE,EAAAA,KAAMF,EAAAA,SAAAA,KAAAA,CAAAA,MAAAA,EAAAA,IAAAA,EAAkB;AAAA,IAAA,IAATG,KAAA,GAAAC,IAAA,CAAAD,KAAA,CAAA;IACb,IAAME,WAAWC,eAAgB,EAAA,CAAA;AAC3B,IAAA,IAAAC,cAAA,GAAiBC,eAAe,QAAQ,CAAA,CAAA;IAC9C,IAAAC,mBAAA,GAAyBC,kBAAmB,EAAA;MAApCC,MAAA,GAAAF,mBAAA,CAAAE,MAAA;MAAQC,IAAK,GAAAH,mBAAA,CAALG,IAAK,CAAA;AAErB,IAAA,IAAAC,OAAA,GAA8BC,OAAOd,MAAK,CAAA;MAAlCe,KAAA,GAAAF,OAAA,CAAAE,KAAA;MAAOC,UAAW,GAAAH,OAAA,CAAXG,UAAW,CAAA;AACpB,IAAA,IAAAC,UAAA,GAA6BC,SAAA,CAAUH,OAAOC,UAAYhB,EAAAA,MAAAA,CAAMmB,YAAcnB,EAAAA,MAAAA,CAAMoB,QAAQ,CAAA;MAAAC,WAAA,GAAAC,cAAA,CAAAL,UAAA,EAAA,CAAA,CAAA;AAA3FM,MAAAA,UAAY,GAAAF,WAAA,CAAA,CAAA,CAAA;AAAAG,MAAAA,YAAY,GAAAH,WAAA,CAAA,CAAA,CAAA,CAAA;AAEzB,IAAA,IAAAI,WAAA,GAAcC,SAAS,YAAM;MACjC,IAAI1B,MAAM,CAAA2B,WAAA,IAAe3B,MAAM,CAAA2B,WAAA,CAAYC,SAAS,CAAG,EAAA;AACrD,QAAA,OAAO5B,OAAM2B,WAAY,CAAA,CAAA,CAAA,CAAA;AAC3B,OAAA;AACO,MAAA,OAAA,IAAA,CAAA;AACT,KAAC,CAAA,CAAA;AACK,IAAA,IAAAE,aAAA,GAAgBH,SAAS,YAAM;MACnC,IAAI1B,MAAM,CAAA2B,WAAA,IAAe3B,MAAM,CAAA2B,WAAA,CAAYC,SAAS,CAAG,EAAA;AACrD,QAAA,OAAO5B,OAAM2B,WAAY,CAAA,CAAA,CAAA,CAAA;AAC3B,OAAA;AACO,MAAA,OAAA,KAAA,CAAA;AACT,KAAC,CAAA,CAAA;IAGD,SAASG,YAAeA,GAAA;AACtB,MAAA,IAAMC,UAAUR,UAAW,CAAAR,KAAA,KAAUU,YAAYV,KAAQ,GAAAc,aAAA,CAAcd,QAAQU,WAAY,CAAAV,KAAA,CAAA;MAE3FS,YAAA,CAAaO,OAAO,CAAA,CAAA;AACtB,KAAA;IAEA,SAASC,MAASA,GAAA;AACZ,MAAA,IAAA3B,QAAA,CAASU,KAASf,IAAAA,MAAAA,CAAMiC,OAAS,EAAA;AACnC,QAAA,OAAA;AACF,OAAA;AACaH,MAAAA,YAAA,EAAA,CAAA;AACf,KAAA;IAGM,IAAAI,OAAA,GAAUR,SAAS,YAAA;AAAA,MAAA,IAAAS,KAAA,CAAA;AAAA,MAAA,OAAM,CAAAC,EAAAA,CAAAA,MAAA,CAC1B7B,cAAe,CAAAQ,KAAA,CAAA,EAClBH,IAAA,CAAKG,MAAMf,MAAM,CAAAqC,IAAA,CAAA,GAAAF,KAAA,GAAAG,EAAAA,EAAAA,eAAA,CAAAH,KAAA,EAEdxB,MAAA,CAAOI,KAAM,CAAAV,QAAA,EAAWA,QAAS,CAAAU,KAAA,CAAAuB,EAAAA,eAAA,CAAAH,KAAA,EACjCxB,MAAA,CAAOI,KAAM,CAAAkB,OAAA,EAAUjC,MAAM,CAAAiC,OAAA,CAAAK,EAAAA,eAAA,CAAAH,KAAA,EAC7BxB,MAAO,CAAAI,KAAA,CAAMgB,OAAU,EAAAR,UAAA,CAAWR,UAAUU,WAAY,CAAAV,KAAA,IAASf,MAAM,CAAAgB,UAAA,KAAeS,WAAY,CAAAV,KAAA,CAAA,EAAAoB,KAAA,EAEtG,CAAA;KAAA,CAAA,CAAA;AACK,IAAA,IAAAI,WAAA,GAAcb,SAAS,YAAM;AAAA,MAAA,IAAAc,KAAA,CAAA;AAC1B,MAAA,OAAA,IAAAJ,MAAA,CACF7B,cAAe,CAAAQ,KAAA,EAAAyB,UAAAA,CAAAA,GAAAA,KAAA,GAAAF,EAAAA,EAAAA,eAAA,CAAAE,KAAA,EAEf7B,MAAA,CAAOI,KAAM,CAAAV,QAAA,EAAWA,QAAS,CAAAU,KAAA,CAAAuB,EAAAA,eAAA,CAAAE,KAAA,EACjC7B,MAAA,CAAOI,KAAM,CAAAkB,OAAA,EAAUjC,MAAM,CAAAiC,OAAA,CAAA,EAAAO,KAAA,EAElC,CAAA;AACF,KAAC,CAAA,CAAA;AACK,IAAA,IAAAC,cAAA,GAAiBf,SAAS,YAAM;MAC7B,OAAA,CAAA,EAAA,CAAAU,MAAA,CACF7B,cAAe,CAAAQ,KAAA,EAAA,WAAA,CAAA,EAClBH,IAAA,CAAKG,MAAMf,MAAM,CAAAqC,IAAA,CAAA,EAAAC,eAAA,CAEd3B,EAAAA,EAAAA,MAAA,CAAOI,KAAM,CAAAV,QAAA,EAAWA,QAAS,CAAAU,KAAA,CAEtC,CAAA,CAAA;AACF,KAAC,CAAA,CAAA;AAED2B,IAAAA,KAAA,CACEnB,UAAA,EACA,UAACoB,GAAQ,EAAA;AACH3C,MAAAA,IAAAA,MAAAA,CAAM2B,WAAe3B,IAAAA,MAAAA,CAAM2B,WAAY,CAAAC,MAAA,IAAU,CAAC5B,MAAM,CAAA2B,WAAA,CAAYiB,QAAS,CAAAD,GAAG,CAAG,EAAA;AACrF,QAAA,MAAM,IAAIE,KAAM,CAAAT,kBAAAA,CAAAA,MAAA,CAAmBU,KAAKC,SAAU/C,CAAAA,MAAAA,CAAM2B,WAAW,CAAG,CAAA,CAAA,CAAA;AACxE,OAAA;AACF,KAAA,EACA;AACEqB,MAAAA,SAAW,EAAA,IAAA;AACb,KAAA,CACF,CAAA;AAEM,IAAA,IAAAC,OAAA,GAAUvB,SAAqB,YAAM;AACrC,MAAA,IAAAwB,UAAA,CAAWlD,MAAM,CAAAmD,KAAK,CAAG,EAAA;AAC3B,QAAA,OAAOnD,OAAMmD,KAAM,CAAAC,CAAA,EAAG;UAAErC,KAAO,EAAAQ,UAAA,CAAWR,KAAAA;AAAM,SAAC,CAAA,CAAA;AACnD,OAAA;AACI,MAAA,IAAAsC,QAAA,CAASrD,MAAM,CAAAmD,KAAK,CAAG,EAAA;QACzB,OAAOnD,MAAM,CAAAmD,KAAA,CAAA;AACf,OAAA;AACA,MAAA,IAAIG,QAAQtD,MAAM,CAAAmD,KAAK,CAAKnD,IAAAA,MAAAA,CAAMmD,MAAMvB,MAAQ,EAAA;QACxC,IAAAuB,KAAA,GAAQ5B,WAAWR,KAAU,KAAAU,WAAA,CAAYV,QAAQf,MAAM,CAAAmD,KAAA,CAAM,CAAKnD,CAAAA,GAAAA,MAAAA,CAAMmD,KAAM,CAAA,CAAA,CAAA,CAAA;QACpF,IAAI,CAACA,KAAA,EAAO,OAAA;AACR,QAAA,IAAAE,QAAA,CAASF,KAAK,CAAG,EAAA;AACZ,UAAA,OAAAA,KAAA,CAAA;AACT,SAAA;AACI,QAAA,IAAAD,UAAA,CAAWC,KAAK,CAAG,EAAA;UACrB,OAAOA,MAAMC,CAAC,CAAA,CAAA;AAChB,SAAA;AACF,OAAA;MACA,IAAIjD,MAAMgD,KAAO,EAAA;QACf,OAAOhD,MAAMgD,KAAM,CAAA;UAAEpC,KAAO,EAAAQ,UAAA,CAAWR,KAAAA;AAAM,SAAC,CAAA,CAAA;AAChD,OAAA;AACO,MAAA,OAAA,IAAA,CAAA;AACT,KAAC,CAAA,CAAA;AACD,IAAA,OAAO,YAAM;AACP,MAAA,IAAAwC,aAAA,CAAA;AACA,MAAA,IAAAC,cAAA,CAAA;MACJ,IAAIxD,OAAMiC,OAAS,EAAA;QACAuB,cAAA,GAAAC,WAAA,CAAAC,OAAA,EAAA;UAAA,MAAe,EAAA,OAAA;SAAQ,EAAA,IAAA,CAAA,CAAA;AAC1C,OAAA,MAAA,IAAWT,QAAQlC,KAAO,EAAA;QACxBwC,aAAA,GAAgBN,OAAQ,CAAAlC,KAAA,CAAA;AAC1B,OAAA;AAGE,MAAA,OAAA0C,WAAA,CAAA,KAAA,EAAA;QAAA,OAAYvB,EAAAA,OAAA,CAAQnB;kBAAiBV,EAAAA,QAAA,CAASU;iBAAgBiB,EAAAA,MAAAA;AAAA,OAAA,EAAA,CAAAyB,WAAA,CAAA,MAAA,EAAA;AAAA,QAAA,OAAA,EAC/ClB,WAAY,CAAAxB,KAAAA;OAAQyC,EAAAA,CAAAA;iBACrBf,cAAe,CAAA1B,KAAAA;AAAA,OAAA,EAAA,CAAQwC;KAGzC,CAAA;AACF,GAAA;AACF,CAAC,CAAA;;;;"}