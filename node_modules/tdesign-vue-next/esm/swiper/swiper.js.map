{"version":3,"file":"swiper.js","sources":["../../src/swiper/swiper.tsx"],"sourcesContent":["import { defineComponent, ref, computed, watch, isVNode, onMounted, cloneVNode } from 'vue';\nimport { ChevronLeftIcon as TdChevronLeftIcon, ChevronRightIcon as TdChevronRightIcon } from 'tdesign-icons-vue-next';\n\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { useChildComponentSlots } from '../hooks';\nimport props from './props';\nimport { SwiperNavigation, SwiperChangeSource } from './type';\nimport TSwiperItem from './swiper-item';\n\nconst defaultNavigation: SwiperNavigation = {\n  placement: 'inside',\n  showSlideBtn: 'always',\n  size: 'medium',\n  type: 'bars',\n};\n\nexport default defineComponent({\n  name: 'TSwiper',\n  props: { ...props },\n  emits: ['update:current'],\n  setup(props, { emit }) {\n    const prefix = usePrefixClass();\n    const { ChevronLeftIcon, ChevronRightIcon } = useGlobalIcon({\n      ChevronLeftIcon: TdChevronLeftIcon,\n      ChevronRightIcon: TdChevronRightIcon,\n    });\n    let swiperTimer: ReturnType<typeof setTimeout> | null = null;\n    let swiperSwitchingTimer = 0;\n    let isBeginToEnd = false;\n    let isEndToBegin = false;\n    const currentIndex = ref(props.current || props.defaultCurrent);\n    const navActiveIndex = ref(props.current || props.defaultCurrent);\n    const isHovering = ref(false);\n    const isSwitching = ref(false);\n    const showArrow = ref(false);\n    const swiperWrap = ref<HTMLElement>();\n    const getChildComponentByName = useChildComponentSlots();\n\n    const swiperItemLength = ref(0);\n    const navigationConfig = computed(() => {\n      return {\n        ...defaultNavigation,\n        ...(isVNode(props.navigation) ? {} : (props.navigation as object)),\n      };\n    });\n    const isEnd = computed(() => {\n      if (props.type === 'card') {\n        return !props.loop && currentIndex.value + 1 >= swiperItemLength.value;\n      }\n      return !props.loop && currentIndex.value + 2 >= swiperItemLength.value;\n    });\n    const propsToUpdateSetTimer = computed(() => {\n      return [props.autoplay, currentIndex.value, props.duration, props.interval];\n    });\n    const swiperWrapClass = computed(() => {\n      return {\n        [`${prefix.value}-swiper__wrap`]: true,\n        [`${prefix.value}-swiper--inside`]: navigationConfig.value.placement === 'inside',\n        [`${prefix.value}-swiper--outside`]: navigationConfig.value.placement === 'outside',\n        [`${prefix.value}-swiper--vertical`]: props.direction === 'vertical',\n        [`${prefix.value}-swiper--large`]: navigationConfig.value.size === 'large',\n        [`${prefix.value}-swiper--small`]: navigationConfig.value.size === 'small',\n      };\n    });\n    const containerStyle = computed(() => {\n      const offsetHeight = props.height ? `${props.height}px` : `${getWrapAttribute('offsetHeight')}px`;\n      if (props.type === 'card' || props.animation === 'fade') {\n        return {\n          height: offsetHeight,\n        };\n      }\n      if (props.animation === 'slide') {\n        const style: Record<string, number | string> = {\n          transition: isSwitching.value ? `transform ${props.duration / 1000}s ease` : '',\n        };\n        let active = currentIndex.value;\n        if (swiperItemLength.value > 1) {\n          active += 1;\n          if (isBeginToEnd || isEndToBegin) {\n            style.transition = '';\n          }\n        }\n        if (props.direction === 'vertical') {\n          style.height = offsetHeight;\n          style.transform = `translate3d(0, -${active * 100}%, 0px)`;\n        } else {\n          style.transform = `translate3d(-${active * 100}%, 0px, 0px)`;\n        }\n        ['msTransform', 'WebkitTransform'].forEach((key) => {\n          style[key] = style.transform;\n        });\n        return style;\n      }\n      return {};\n    });\n    const swiperItems = () => {\n      const swiperItemList = getChildComponentByName('SwiperItem');\n      swiperItemLength.value = swiperItemList.length;\n      const items = swiperItemList.map((swiperItem: any, index) => {\n        const p = { ...props, ...swiperItem.props };\n        return (\n          <TSwiperItem\n            index={index}\n            currentIndex={currentIndex.value}\n            isSwitching={isSwitching.value}\n            getWrapAttribute={getWrapAttribute}\n            swiperItemLength={swiperItemLength.value}\n            {...p}\n          >\n            {swiperItem.children.default()}\n          </TSwiperItem>\n        );\n      });\n      if (props.animation === 'slide' && items.length > 1) {\n        const first = cloneVNode(items[0], {\n          key: `swiper-item-append-${0}`,\n        });\n        const last = cloneVNode(items[items.length - 1], {\n          key: `swiper-item-prepend-${items.length - 1}`,\n        });\n        items.unshift(last);\n        items.push(first);\n      }\n      return items;\n    };\n\n    const swiperTo = (index: number, context: { source: SwiperChangeSource }) => {\n      let targetIndex = index % swiperItemLength.value;\n      navActiveIndex.value = targetIndex;\n      emit('update:current', targetIndex);\n      props.onChange?.(targetIndex, context);\n      isSwitching.value = true;\n      if (props.animation === 'slide' && swiperItemLength.value > 1 && props.type !== 'card') {\n        targetIndex = index;\n        isBeginToEnd = false;\n        isEndToBegin = false;\n        if (index >= swiperItemLength.value) {\n          clearTimer();\n          setTimeout(() => {\n            isEndToBegin = true;\n            currentIndex.value = 0;\n          }, props.duration);\n        }\n        if (currentIndex.value === 0) {\n          if (\n            (swiperItemLength.value > 2 && index === swiperItemLength.value - 1) ||\n            (swiperItemLength.value === 2 && index === 0)\n          ) {\n            targetIndex = -1;\n            navActiveIndex.value = swiperItemLength.value - 1;\n            clearTimer();\n            setTimeout(() => {\n              isBeginToEnd = true;\n              currentIndex.value = swiperItemLength.value - 1;\n            }, props.duration);\n          }\n        }\n      }\n      currentIndex.value = targetIndex;\n    };\n    const clearTimer = () => {\n      if (swiperTimer) {\n        clearTimeout(swiperTimer);\n        swiperTimer = null;\n      }\n    };\n    const setTimer = () => {\n      if (props.autoplay && props.interval > 0) {\n        clearTimer();\n        swiperTimer = setTimeout(\n          () => {\n            swiperTo(currentIndex.value + 1, { source: 'autoplay' });\n          },\n          currentIndex.value === 0 ? props.interval - (props.duration + 50) : props.interval, // 当 index 为 0 的时候，表明刚从克隆的最后一项跳转过来，已经经历了duration + 50 的间隔时间，减去即可\n        );\n      }\n    };\n\n    const onMouseEnter = () => {\n      isHovering.value = true;\n      if (props.stopOnHover) {\n        clearTimer();\n      }\n      if (navigationConfig.value.showSlideBtn === 'hover') {\n        showArrow.value = true;\n      }\n    };\n    const onMouseLeave = () => {\n      isHovering.value = false;\n      if (!isEnd.value) {\n        setTimer();\n      }\n      if (navigationConfig.value.showSlideBtn === 'hover') {\n        showArrow.value = false;\n      }\n    };\n    const onMouseEnterNavigationItem = (i: number) => {\n      if (props.trigger === 'hover') {\n        swiperTo(i, { source: 'hover' });\n      }\n    };\n    const onClickNavigationItem = (i: number) => {\n      if (props.trigger === 'click') {\n        swiperTo(i, { source: 'click' });\n      }\n    };\n    const goNext = (context: { source: SwiperChangeSource }) => {\n      if (isSwitching.value) return;\n      if (props.type === 'card') {\n        return swiperTo(currentIndex.value + 1 >= swiperItemLength.value ? 0 : currentIndex.value + 1, context);\n      }\n      return swiperTo(currentIndex.value + 1, context);\n    };\n    const goPrevious = (context: { source: SwiperChangeSource }) => {\n      if (isSwitching.value) return;\n      if (currentIndex.value - 1 < 0) {\n        if (props.animation === 'slide' && swiperItemLength.value === 2) {\n          return swiperTo(0, context);\n        }\n        return swiperTo(swiperItemLength.value - 1, context);\n      }\n      return swiperTo(currentIndex.value - 1, context);\n    };\n    const getWrapAttribute = (attr: string) => {\n      return swiperWrap.value?.parentNode?.[attr];\n    };\n    const renderPagination = () => {\n      const fractionIndex = currentIndex.value + 1 > swiperItemLength.value ? 1 : currentIndex.value + 1;\n      return (\n        <div class={`${prefix.value}-swiper__arrow`}>\n          <div class={`${prefix.value}-swiper__arrow-left`} onClick={() => goPrevious({ source: 'click' })}>\n            <ChevronLeftIcon />\n          </div>\n          <div class={`${prefix.value}-swiper__navigation-text-fraction`}>\n            {fractionIndex}/{swiperItemLength.value}\n          </div>\n          <div class={`${prefix.value}-swiper__arrow-right`} onClick={() => goNext({ source: 'click' })}>\n            <ChevronRightIcon />\n          </div>\n        </div>\n      );\n    };\n    const renderArrow = () => {\n      if (!showArrow.value) return null;\n      return (\n        <div class={[`${prefix.value}-swiper__arrow`, `${prefix.value}-swiper__arrow--default`]}>\n          <div class={`${prefix.value}-swiper__arrow-left`} onClick={() => goPrevious({ source: 'click' })}>\n            <ChevronLeftIcon />\n          </div>\n          <div class={`${prefix.value}-swiper__arrow-right`} onClick={() => goNext({ source: 'click' })}>\n            <ChevronRightIcon />\n          </div>\n        </div>\n      );\n    };\n    const renderNavigation = () => {\n      if (isVNode(props.navigation)) return props.navigation;\n      if (navigationConfig.value.type === 'fraction') {\n        return (\n          <div class={[`${prefix.value}-swiper__navigation`, `${prefix.value}-swiper__navigation--fraction`]}>\n            {renderPagination()}\n          </div>\n        );\n      }\n      const swiperItemList = getChildComponentByName('SwiperItem');\n      return (\n        <ul\n          class={[\n            `${prefix.value}-swiper__navigation`,\n            {\n              [`${prefix.value}-swiper__navigation-bars`]: navigationConfig.value.type === 'bars',\n              [`${prefix.value}-swiper__navigation-dots`]: navigationConfig.value.type === 'dots',\n              [`${prefix.value}-swiper__navigation-dots-bar`]: navigationConfig.value.type === 'dots-bar',\n            },\n          ]}\n        >\n          {swiperItemList.map((_, i: number) => (\n            <li\n              key={i}\n              class={[\n                `${prefix.value}-swiper__navigation-item`,\n                {\n                  [`${prefix.value}-is-active`]: i === navActiveIndex.value,\n                },\n              ]}\n              onMouseenter={() => onMouseEnterNavigationItem(i)}\n              onClick={() => onClickNavigationItem(i)}\n            >\n              <span></span>\n            </li>\n          ))}\n        </ul>\n      );\n    };\n    const renderSwiperItems = () => {\n      return swiperItems();\n    };\n\n    watch(\n      () => propsToUpdateSetTimer.value,\n      () => {\n        setTimer();\n      },\n    );\n    watch(\n      () => isSwitching.value,\n      () => {\n        if (isSwitching.value) {\n          if (swiperSwitchingTimer) clearTimeout(swiperSwitchingTimer);\n          swiperSwitchingTimer = setTimeout(() => {\n            isSwitching.value = false;\n            swiperSwitchingTimer = 0;\n            if (isEnd.value) {\n              clearTimer();\n            }\n          }, props.duration + 50) as unknown as number;\n        }\n      },\n    );\n    watch(\n      () => props.current,\n      () => {\n        swiperTo(props.current, { source: 'autoplay' });\n      },\n    );\n\n    onMounted(() => {\n      setTimer();\n      showArrow.value = navigationConfig.value.showSlideBtn === 'always';\n    });\n\n    return () => (\n      <div class={[`${prefix.value}-swiper`]} onMouseenter={onMouseEnter} onMouseleave={onMouseLeave} ref={swiperWrap}>\n        <div class={swiperWrapClass.value}>\n          <div\n            class={[\n              `${prefix.value}-swiper__content`,\n              {\n                [`${prefix.value}-swiper-fade`]: props.animation === 'fade',\n                [`${prefix.value}-swiper-card`]: props.type === 'card',\n              },\n            ]}\n          >\n            <div class={`${prefix.value}-swiper__container`} style={containerStyle.value}>\n              {renderSwiperItems()}\n            </div>\n          </div>\n          {renderNavigation()}\n          {renderArrow()}\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","defaultNavigation","placement","showSlideBtn","size","type","defineComponent","name","props","_objectSpread","emits","setup","emit","_ref","prefix","usePrefixClass","_useGlobalIcon","useGlobalIcon","ChevronLeftIcon","TdChevronLeftIcon","ChevronRightIcon","TdChevronRightIcon","swiperTimer","swiperSwitchingTimer","isBeginToEnd","isEndToBegin","currentIndex","ref","current","defaultCurrent","navActiveIndex","isHovering","isSwitching","showArrow","swiperWrap","getChildComponentByName","useChildComponentSlots","swiperItemLength","navigationConfig","computed","isVNode","navigation","isEnd","loop","value","propsToUpdateSetTimer","autoplay","duration","interval","swiperWrapClass","_ref2","_defineProperty","concat","direction","containerStyle","offsetHeight","height","getWrapAttribute","animation","style","transition","active","transform","forEach","key","swiperItems","swiperItemList","length","items","map","swiperItem","index","_slot","p","_createVNode","TSwiperItem","_mergeProps","children","first","cloneVNode","last","unshift","push","swiperTo","context","_props2$onChange","targetIndex","onChange","clearTimer","setTimeout","clearTimeout","setTimer","source","onMouseEnter","stopOnHover","onMouseLeave","onMouseEnterNavigationItem","i","trigger","onClickNavigationItem","goNext","goPrevious","attr","_swiperWrap$value","_swiperWrap$value$par","parentNode","renderPagination","fractionIndex","onClick","renderArrow","renderNavigation","_ref3","_","onMouseenter","renderSwiperItems","watch","onMounted","_ref5"],"mappings":"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"}