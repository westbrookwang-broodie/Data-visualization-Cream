{"version":3,"file":"message.js","sources":["../../src/message/message.tsx"],"sourcesContent":["import { defineComponent, h, onBeforeMount, onMounted, computed, ref } from 'vue';\nimport {\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n  HelpCircleFilledIcon as TdHelpCircleFilledIcon,\n  CloseIcon as TdCloseIcon,\n} from 'tdesign-icons-vue-next';\n\nimport TLoading from '../loading';\nimport { THEME_LIST } from './const';\nimport props from './props';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { fadeIn, fadeOut } from './animation';\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\nimport isFunction from 'lodash/isFunction';\n\nexport default defineComponent({\n  name: 'TMessage',\n  props: {\n    ...props,\n    placement: String, // just for animation\n  },\n  setup(props, { slots, expose }) {\n    const COMPONENT_NAME = usePrefixClass('message');\n    const { InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon, HelpCircleFilledIcon, CloseIcon } =\n      useGlobalIcon({\n        InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n        CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n        ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n        HelpCircleFilledIcon: TdHelpCircleFilledIcon,\n        CloseIcon: TdCloseIcon,\n      });\n    const classPrefix = usePrefixClass();\n\n    const renderTNode = useTNodeJSX();\n    const renderContent = useContent();\n\n    const msgRef = ref(null);\n    const timer = ref(null);\n\n    const classes = computed(() => {\n      const status = {};\n      THEME_LIST.forEach((t) => (status[`${classPrefix.value}-is-${t}`] = props.theme === t));\n      return [\n        COMPONENT_NAME.value,\n        status,\n        {\n          [`${classPrefix.value}-is-closable`]: props.closeBtn || slots.closeBtn,\n        },\n      ];\n    });\n\n    const close = (e?: MouseEvent) => {\n      props.onCloseBtnClick?.({ e });\n    };\n\n    const clearTimer = () => {\n      props.duration && clearTimeout(timer.value);\n    };\n\n    const setTimer = () => {\n      if (!props.duration) {\n        return;\n      }\n      timer.value = Number(\n        setTimeout(() => {\n          clearTimer();\n          const msgDom = msgRef.value as HTMLElement;\n          fadeOut(msgDom, props.placement, () => {\n            props.onDurationEnd?.();\n          });\n        }, props.duration),\n      );\n    };\n\n    const renderClose = () => {\n      const defaultClose = <CloseIcon />;\n      return (\n        <span class={`${COMPONENT_NAME.value}__close`} onClick={close}>\n          {renderTNode('closeBtn', defaultClose)}\n        </span>\n      );\n    };\n\n    const renderIcon = () => {\n      if (props.icon === false) return;\n      if (isFunction(props.icon)) return props.icon(h);\n      if (slots.icon) {\n        return slots.icon(null);\n      }\n      const Icon = {\n        info: InfoCircleFilledIcon,\n        success: CheckCircleFilledIcon,\n        warning: ErrorCircleFilledIcon,\n        error: ErrorCircleFilledIcon,\n        question: HelpCircleFilledIcon,\n        loading: TLoading,\n      }[props.theme];\n      return <Icon />;\n    };\n\n    onBeforeMount(() => {\n      props.duration && setTimer();\n    });\n\n    onMounted(() => {\n      const msgDom = msgRef.value;\n      fadeIn(msgDom, props.placement);\n    });\n\n    expose({ close });\n\n    return () => (\n      <div ref={msgRef} class={classes.value} onMouseenter={clearTimer} onMouseleave={setTimer}>\n        {renderIcon()}\n        {renderContent('content', 'default')}\n        {renderClose()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","placement","String","setup","slots","_ref","expose","COMPONENT_NAME","usePrefixClass","_useGlobalIcon","useGlobalIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","HelpCircleFilledIcon","TdHelpCircleFilledIcon","CloseIcon","TdCloseIcon","classPrefix","renderTNode","useTNodeJSX","renderContent","useContent","msgRef","ref","timer","classes","computed","status","THEME_LIST","forEach","t","concat","value","theme","_defineProperty","closeBtn","close","e","_props2$onCloseBtnCli","onCloseBtnClick","clearTimer","duration","clearTimeout","setTimer","Number","setTimeout","msgDom","fadeOut","_props2$onDurationEnd","onDurationEnd","renderClose","defaultClose","_createVNode","renderIcon","icon","isFunction","h","Icon","info","success","warning","error","question","loading","TLoading","onBeforeMount","onMounted","fadeIn"],"mappings":"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"}